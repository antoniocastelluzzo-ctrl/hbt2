const scriptURL = "https://script.google.com/macros/s/AKfycbysYOdXDzv-mpu_cjXDJiE7BWKvsJcQI1s27xV2UfJQVBNgP5rdsShS8-0lJTrlvNLE/exec";
document.getElementById('request-form').addEventListener('submit', async function(e) {
  e.preventDefault();
  const form = e.target;
  const data = new FormData(form);
  const responseDiv = document.getElementById('form-response');
  responseDiv.textContent = 'Invio in corso...';
  responseDiv.className = '';
  try {
    const response = await fetch(scriptURL, {
      method: 'POST',
      body: data
    });
    if (response.ok) {
      responseDiv.textContent = 'Richiesta inviata con successo!';
      responseDiv.className = 'success';
      form.reset();
    } else {
      responseDiv.textContent = 'Errore durante l\'invio.';
      responseDiv.className = 'error';
    }
  } catch (error) {
    responseDiv.textContent = 'Errore di rete o servizio non disponibile.';
    responseDiv.className = 'error';
  }
});